<link rel="import" href="../../iron-a11y-announcer/iron-a11y-announcer.html">

<script>
	'use strict';
	window.D2L = window.D2L || {};
	window.D2L.PolymerBehaviors = window.D2L.PolymerBehaviors || {};
	window.D2L.PolymerBehaviors.Rubric = window.D2L.PolymerBehaviors.Rubric || {};

	window.D2L.Rubric = window.D2L.Rubric || {};

	/**
	 * Behavior for Dropdowns
	 * @polymerBehavior
	 */
	D2L.PolymerBehaviors.Rubric.DropdownMenuBehavior = {
		behaviors: [],
		attached: function() {
			Polymer.IronA11yAnnouncer.requestAvailability();
		},
		disableMenu: function(menuButton) {
			Polymer.dom(menuButton).setAttribute('disabled','');
		},

		enableMenu: function(menuButton) {
			Polymer.dom(menuButton).removeAttribute('disabled');
		},
		resetSelectedMenuItem: function(menuButton, optionValue) {
			var items = Polymer.dom(menuButton).querySelectorAll('d2l-menu-item-radio');
			for (var i = 0; i < items.length; i++) {
				if (items[i].value === optionValue) {
					items[i].setAttribute('selected', '');
				} else {
					items[i].removeAttribute('selected');
				}
			}
		},
		populateDropdownMenuOptions: function(menuId, options) {
			var menu = this.$[menuId];
			var selected = null;

			var oldItems = Polymer.dom(menu).childNodes;
			for (var i = 0; i < oldItems.length; i++) {
				Polymer.dom(menu).removeChild(oldItems[i]);
			}

			for (var i = 0; i < options.length; i++) {
				var option = options[i];
				var item = document.createElement('d2l-menu-item-radio');
				Polymer.dom(item).setAttribute('text', option.title);
				Polymer.dom(item).setAttribute('value', option.value);
				if (option.selected) {
					selected = option;
					Polymer.dom(item).setAttribute('selected', '');
				}
				Polymer.dom(menu).appendChild(item);
			}
			return selected;
		}
	};
</script>
